//directional influence
dio=dix
if (coll) dif=0
else {
    dix=(dix*11+h)/12
    if (sign(dix-dio)=h) dif=5 else dif=0
}
di=(dix-dio)*dif
